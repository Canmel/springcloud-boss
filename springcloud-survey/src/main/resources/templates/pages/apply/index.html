<div id="subContainer" class="wrapper wrapper-content">
    <div class="ibox float-e-margins">
        <div class="ibox-content">
            <ul class="nav nav-tabs">
                <li class="active"><a data-toggle="tab" href="#tab-1" aria-expanded="false"
                                      @click="loadData(1)">综合培训考核</a>
                </li>
                <li class=""><a data-toggle="tab" href="#tab-2" aria-expanded="true" @click="loadData(2)"> 问卷调查申请</a>
                </li>
                <li class=""><a data-toggle="tab" href="#tab-3" aria-expanded="false" @click="loadData(3)">班次申请</a>
                </li>
            </ul>
            <div class="tab-content">
                <div id="tab-1" class="tab-pane active">
                    <table class="table table-striped table-hover">
                        <tbody>
                        <tr v-for="item in applies">
                            <td class="client-avatar"><span class="fa fa-user"></span></td>
                            <td><a data-toggle="tab" href="#contact-1" class="client-link">{{item.creator.username}}</a>
                            </td>
                            <td class="contact-type"><i class="fa fa-phone"> </i>
                            <td> {{item.creator.mobile}}</td>
                            </td>
                            <td> {{item.createdAt}}</td>
                            <td class="client-status">
                                        <span class="label label-primary" style="cursor: pointer;"
                                              v-on:click="agreen(item)">同意</span>
                                <span class="label label-danger" style="cursor: pointer;"
                                      v-on:click="refuse(item)">拒绝</span>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <div id="tab-2" class="tab-pane">
                    <table class="table table-striped table-hover">
                        <tbody>
                        <tr v-for="item in passed">
                            <td class="client-avatar"><span class="fa fa-user"></span></td>
                            <td><a data-toggle="tab" href="#contact-1" class="client-link">{{item.creator.username}}</a>
                            </td>
                            <td class="contact-type"><i class="fa fa-phone"> </i>
                            <td> {{item.creator.mobile}}</td>
                            </td>
                            <td> {{item.createdAt}}</td>
                            <td class="client-status">
                                        <span class="label label-primary" style="cursor: pointer;"
                                              v-on:click="agreen(item)">同意</span>
                                <span class="label label-danger" style="cursor: pointer;"
                                      v-on:click="refuse(item)">拒绝</span>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                    <pageination :total="queryParams.total" :size="queryParams.size"
                                 :page="queryParams.pageNum"
                                 :changge="applyPageFn"></pageination>
                </div>
                <div id="tab-3" class="tab-pane">
                    <table class="table table-striped table-hover">
                        <tbody>
                        <tr v-for="item in refused">
                            <td class="client-avatar"><span class="fa fa-user"></span></td>
                            <td><a data-toggle="tab" href="#contact-1" class="client-link">{{item.creator.username}}</a>
                            </td>
                            <td class="contact-type"><i class="fa fa-phone"> </i>
                            <td> {{item.creator.mobile}}</td>
                            </td>
                            <td> {{item.createdAt}}</td>
                            <td class="client-status">
                                        <span class="label label-primary" style="cursor: pointer;"
                                              v-on:click="agreen(item)">同意</span>
                                <span class="label label-danger" style="cursor: pointer;"
                                      v-on:click="refuse(item)">拒绝</span>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                    <pageination :total="queryParams.total" :size="queryParams.size"
                                 :page="queryParams.pageNum"
                                 :changge="applyPageFn"></pageination>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="/survey/js/validateIsMain.js"></script>
<script>
    var vue = new Vue({
        el: '#subContainer',
        data: {
            applicationContextRootPath: '/survey/',
            queryParams: {
                pageNum: 1,
                ach: 'APPLY',
                total: 0,//总页数
                size: 10//每页显示条目个数不传默认10
            },
            applies: [],
            passed: [],
            refused: []
        },
        created: function () {
        },
        methods: {
            loadData(v) {
                this.pageFnDelivery()
            },
            pageQueryApplies() {
                let that = this;
                AJAX.GET('zsDelivery', this.queryParams, function (resp) {
                    that.applies = resp.data.list;
                    that.queryParams.pageNum = resp.data.pageNum;
                    that.queryParams.total = resp.data.total;
                });
            },
            pageQueryPassed() {
                let that = this;
                AJAX.GET('zsDelivery', this.queryParams, function (resp) {
                    that.passed = resp.data.list;
                    that.queryParams.pageNum = resp.data.pageNum;
                    that.queryParams.total = resp.data.total;
                });
            },
            pageQueryRefused() {
                let that = this;
                AJAX.GET('zsDelivery', this.queryParams, function (resp) {
                    that.refused = resp.data.list;
                    that.queryParams.pageNum = resp.data.pageNum;
                    that.queryParams.total = resp.data.total;
                });
            },
            applyPageFn(val) {
                this.queryParams.pageNum = val;
                this.pageQueryApplies();
            }

        }
    });
</script>
