<div id="subContainer" class="wrapper wrapper-content">
    <div class="ibox float-e-margins">
        <div class="ibox-content">
            <form class="form-horizontal m-t" id="signupForm">
                <div class="form-group">
                    <label class="col-sm-3 control-label">坐席号：</label>
                    <div class="col-sm-8">
                        <input id="seatNum" name="seatNum" class="form-control" type="text" v-model="seat.seatNum" disabled="disabled">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-3 control-label">坐席密码：</label>
                    <div class="col-sm-8">
                        <input id="password" name="password" class="form-control" type="text" aria-required="true"
                               aria-invalid="false" class="valid" v-model="seat.password">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-3 control-label">描述信息：</label>
                    <div class="col-sm-8">
                        <input id="description" name="description" class="form-control" type="text" aria-required="true"
                               aria-invalid="true" class="error" v-model="seat.description">
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-sm-8 col-sm-offset-3">
                        <button type="button" class="btn btn-secondary" v-on:click="cancel()">取消</button>
                        <button type="button" class="btn btn-primary" v-on:click="save()">保存</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
<script src="/survey/js/validateIsMain.js"></script>
<script>
    new Vue({
        el: '#subContainer',
        data: {
            applicationContextRootPath: '/survey/',
            seat: {
                seatNum: '',
                password: '',
                description: ''
            }
        },
        created: function () {
            this.loadEntity();
        },
        methods: {
            loadEntity() {
                var that = this;
                AJAX.GET('zsSeat/' + sessionStorage.getItem('editParams'), {}, function (resp) {
                    that.seat = {
                        id: resp.data.id,
                        seatNum: resp.data.seatNum,
                        password: resp.data.password,
                        description: resp.data.description
                    };
                })
            },
            cancel: function () {
                this.backToMain();
            },
            save: function () {
                console.log($("#signupForm").valid());
                if (!$("#signupForm").valid()) {
                    return false;
                }
                var that = this;
                AJAX.PUT('zsSeat', JSON.stringify(this.seat), function (resp) {
                    toastr.success(resp.msg);
                    that.backToMain();
                });
            },
            backToMain: function () {
                $.pjax({
                    url: mvm.applicationContextRootPath + 'pages/seat/index.html',
                    container: '.page-container'
                });
            }
        }
    });
</script>