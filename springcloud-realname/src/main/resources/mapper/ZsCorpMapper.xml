<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.camel.realname.mapper.ZsCorpMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.camel.realname.model.ZsCorp">
        <id column="id" property="id" javaType="java.lang.Integer"/>
        <result column="request_id" property="requestId" javaType="java.lang.String"/>
        <result column="is_merge" property="isMerge" javaType="java.lang.Integer"/>
        <result column="enterprise_name" property="enterpriseName" javaType="java.lang.String"/>
        <result column="business_license_code" property="businessLicenseCode" javaType="java.lang.String"/>
        <result column="business_license_url" property="businessLicenseUrl" javaType="java.lang.String"/>
        <result column="corporate_name" property="corporateName" javaType="java.lang.String"/>
        <result column="corporate_id_url" property="corporateIdUrl" javaType="java.lang.String"/>
        <result column="corporate_id_hurl" property="corporateIdHurl" javaType="java.lang.String"/>
        <result column="business_start_date" property="businessStartDate" javaType="java.util.Date"/>
        <result column="business_term_start_date" property="businessTermStartDate" javaType="java.util.Date"/>
        <result column="business_term_end_date" property="businessTermEndDate" javaType="java.util.Date"/>
        <result column="business_address" property="businessAddress" javaType="java.lang.String"/>
        <result column="business_no" property="businessNo" javaType="java.lang.String"/>
        <result column="organization_code" property="organizationCode" javaType="java.lang.String"/>
        <result column="organization_code_url" property="organizationCodeUrl" javaType="java.lang.String"/>
        <result column="organization_name" property="organizationName" javaType="java.lang.String"/>
        <result column="organization_type" property="organizationType" javaType="java.lang.Integer"/>
        <result column="organization_effective_date" property="organizationEffectiveDate" javaType="java.util.Date"/>
        <result column="organization_expiration_date" property="organizationExpirationDate" javaType="java.util.Date"/>
        <result column="entrustment_letter_url" property="entrustmentLetterUrl" javaType="java.lang.String"/>
        <result column="acceptance_url" property="acceptanceUrl" javaType="java.lang.String"/>
        <result column="apply_sheet_url" property="applySheetUrl" javaType="java.lang.String"/>
        <result column="agent_name" property="agentName" javaType="java.lang.String"/>
        <result column="agent_pid" property="agentPid" javaType="java.lang.String"/>
        <result column="agent_id_turl" property="agentIdTurl" javaType="java.lang.String"/>
        <result column="agent_id_url" property="agentIdUrl" javaType="java.lang.String"/>
        <result column="agent_id_hurl" property="agentIdHurl" javaType="java.lang.String"/>
        <result column="agent_id_address" property="agentIdAddress" javaType="java.lang.String"/>
        <result column="agent_id_gender" property="agentIdGender" javaType="java.lang.Integer"/>
        <result column="agent_id_nation" property="agentIdNation" javaType="java.lang.String"/>
        <result column="agent_id_birth_day" property="agentIdBirthDay" javaType="java.util.Date"/>
        <result column="agent_id_issuing_authority" property="agentIdIssuingAuthority" javaType="java.lang.String"/>
        <result column="agent_id_cert_valid_date" property="agentIdCertValidDate" javaType="java.util.Date"/>
        <result column="agent_id_cert_exp_date" property="agentIdCertExpDate" javaType="java.util.Date"/>
        <result column="agent_contact_no" property="agentContactNo" javaType="java.lang.String"/>
        <result column="agent_address" property="agentAddress" javaType="java.lang.String"/>
        <result column="contact_name" property="contactName" javaType="java.lang.String"/>
        <result column="contact_no" property="contactNo" javaType="java.lang.String"/>
        <result column="contact_id_url" property="contactIdUrl" javaType="java.lang.String"/>
        <result column="user_id" property="userId" javaType="java.lang.Integer"/>
        <result column="submit_date" property="submitDate" javaType="java.util.Date"/>
        <result column="status" property="status" typeHandler="com.camel.realname.enumhandler.MyIntegerToEnumHandler"/>
        <result column="apply" property="apply" typeHandler="com.camel.realname.enumhandler.MyIntegerToEnumHandler"/>
        <result column="is_pay" property="isPay" typeHandler="com.camel.realname.enumhandler.MyIntegerToEnumHandler"/>
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
        zs_corp.id,zs_corp.request_id,zs_corp.is_merge,zs_corp.enterprise_name,zs_corp.business_license_code,
        zs_corp.business_license_url,zs_corp.corporate_name,zs_corp.corporate_id_url,zs_corp.corporate_id_hurl,zs_corp.business_start_date,
        zs_corp.business_term_start_date,zs_corp.business_term_end_date,zs_corp.business_address,
        zs_corp.business_no,zs_corp.organization_code,zs_corp.organization_code_url,zs_corp.organization_name,
        zs_corp.organization_type,zs_corp.organization_effective_date,zs_corp.rganization_expiration_date,
        zs_corp.entrustment_letter_url,zs_corp.acceptance_url,zs_corp.apply_sheet_url,zs_corp.agent_name,zs_corp.agent_pid,zs_corp.agent_id_turl,
        zs_corp.agent_id_url,zs_corp.agent_id_hurl,zs_corp.agent_id_address,zs_corp.agent_id_gender,
        zs_corp.agent_id_nation,zs_corp.agent_id_birth_day,zs_corp.agent_id_issuing_authority,
        zs_corp.agent_id_cert_valid_date,zs_corp.agent_id_cert_exp_date,zs_corp.agent_contact_no,
        zs_corp.agent_address,zs_corp.contact_name,zs_corp.contact_no,zs_corp.contact_id_url,zs_corp.user_id,zs_corp.status,
        zs_corp.submit_date, zs_corp.status, zs_corp.apply,approve_order.is_pay
    </sql>

    <insert id="insertDemo">
        INSERT INTO zs_corp
            ( is_merge,agent_id_gender,user_id,status)
        VALUES
            ( 1, 0, #{userId},#{status});
    </insert>

    <update id="updateCorp">
        update zs_corp
        <set>
            <if test="requestId != null and requestId != ''">request_id = #{requestId},</if>
            <if test="isMerge != null">is_merge = #{isMerge},</if>
            <if test="enterpriseName != null and enterpriseName != ''">enterprise_name = #{enterpriseName},</if>
            <if test="businessLicenseCode != null and businessLicenseCode != ''">business_license_code = #{businessLicenseCode},</if>
            <if test="businessLicenseUrl != null and businessLicenseUrl != ''">business_license_url = #{businessLicenseUrl},</if>
            <if test="corporateName != null and corporateName != ''">corporate_name = #{corporateName},</if>
            <if test="corporateIdUrl != null and corporateIdUrl != ''">corporate_id_url = #{corporateIdUrl},</if>
            <if test="corporateIdHurl != null and corporateIdHurl != ''">corporate_id_hurl = #{corporateIdHurl},</if>
            <if test="businessStartDate != null">business_start_date = #{businessStartDate},</if>
            <if test="businessTermStartDate != null">business_term_start_date = #{businessTermStartDate},</if>
            <if test="businessTermEndDate != null">business_term_end_date = #{businessTermEndDate},</if>
            <if test="businessAddress != null and businessAddress != ''">business_address = #{businessAddress},</if>
            <if test="businessNo != null and businessNo != ''">business_no = #{businessNo},</if>
            <if test="organizationCode != null and organizationCode != ''">organization_code = #{organizationCode},</if>
            <if test="organizationCodeUrl != null and organizationCodeUrl != ''">organization_code_url = #{organizationCodeUrl},</if>
            <if test="organizationName != null and organizationName != ''">organization_name = #{organizationName},</if>
            <if test="organizationType != null">organization_type = #{organizationType},</if>
            <if test="organizationEffectiveDate != null">organization_effective_date = #{organizationEffective},</if>
            <if test="organizationExpirationDate != null">organization_expiration_date = #{organizationExpirationDate},</if>
            <if test="entrustmentLetterUrl != null and entrustmentLetterUrl != ''">entrustment_letter_url = #{entrustmentLetterUrl},</if>
            <if test="acceptanceUrl != null and acceptanceUrl != ''">acceptance_url = #{acceptanceUrl},</if>
            <if test="applySheetUrl != null and applySheetUrl != ''">apply_sheet_url = #{applySheetUrl},</if>
            <if test="agentName != null and agentName != ''">agent_name = #{agentName},</if>
            <if test="agentPid != null and agentPid != ''">agent_pid = #{agentPid},</if>
            <if test="agentIdTurl != null and agentIdTurl != ''">agent_id_turl = #{agentIdTurl},</if>
            <if test="agentIdUrl != null and agentIdUrl != ''">agent_id_url = #{agentIdUrl},</if>
            <if test="agentIdHurl != null and agentIdHurl != ''">agent_id_hurl = #{agentIdHurl},</if>
            <if test="agentIdAddress != null and agentIdAddress != ''">agent_id_address = #{agentIdAddress},</if>
            <if test="agentIdGender != null and agentIdGender != ''">agent_id_gender = #{agentIdGender},</if>
            <if test="agentIdNation != null and agentIdNation != ''">agent_id_nation = #{agentIdNation},</if>
            <if test="agentIdBirthDay != null">agent_id_birth_day = #{agentIdBirthDay},</if>
            <if test="agentIdIssuingAuthority != null and agentIdIssuingAuthority != ''">agent_id_issuing_authority = #{agentIdIssuingAuthority},</if>
            <if test="agentIdCertValidDate != null">agent_id_cert_valid_date = #{agentIdCertValidDate},</if>
            <if test="agentIdCertExpDate != null">agent_id_cert_exp_date = #{agentIdCertExpDate},</if>
            <if test="agentContactNo != null and agentContactNo != ''">agent_contact_no = #{agentContactNo},</if>
            <if test="agentAddress != null and agentAddress != ''">agent_address = #{agentAddress},</if>
            <if test="contactName != null and contactName != ''">contact_name = #{contactName},</if>
            <if test="contactNo != null and contactNo != ''">contact_no = #{contactNo},</if>
            <if test="contactIdUrl != null and contactIdUrl != ''">contact_id_url = #{contactIdUrl},</if>
            <if test="apply != null">apply = #{apply.code},</if>
            <if test="status != null">status = #{status.code},</if>
        </set>
        where user_id = #{userId}
    </update>

    <update id="audit">
        update zs_corp set apply = #{apply}
        where id = #{id}
    </update>

    <select id="getOneByUid" resultMap="BaseResultMap">
        select <include refid="Base_Column_List"/> from zs_corp
        left join approve_order on zs_corp.user_id = approve_order.user_id
        where zs_corp.user_id = #{userId}
        and zs_corp.status = 1
        limit 1
    </select>

    <select id="getList" resultMap="BaseResultMap">
        select <include refid="Base_Column_List"/> from zs_corp
        left join approve_order on zs_corp.user_id = approve_order.user_id
        <where>
            <if test="enterpriseName != null and enterpriseName != ''">zs_corp.enterprise_name like concat('%',#{enterpriseName},'%')</if>
            <if test="corporateName != null and corporateName != ''">and zs_corp.corporate_name like concat('%',#{corporateName},'%')</if>
            <if test="enterpriseName != null and businessLicenseCode != ''">and zs_corp.business_license_code like concat('%',#{businessLicenseCode},'%')</if>
            <if test="agentName != null and agentName != ''">and zs_corp.agent_name like concat('%',#{agentName},'%')</if>
            <if test="agentPid != null and agentPid != ''">and zs_corp.agent_pid like concat('%',#{agentPid},'%')</if>
            <if test="agentContactNo != null and agentContactNo != ''">and zs_corp.agent_contact_no like concat('%',#{agentContactNo},'%')</if>
            <if test="agentIdIssuingAuthority != null and agentIdIssuingAuthority != ''">and zs_corp.agent_id_issuing_authority like concat('%',#{agentIdIssuingAuthority},'%')</if>
            and zs_corp.status = 1
            and zs_corp.apply >= 2
        </where>
    </select>
    <select id="selectById" resultType="com.camel.realname.model.ZsCorp">
        select <include refid="Base_Column_List"/> from zs_corp
        left join approve_order on zs_corp.user_id = approve_order.user_id
        where zs_corp.id = #{id}
        and zs_corp.status = 1
        limit 1
    </select>
</mapper>
