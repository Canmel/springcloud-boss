<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>推荐收益</title>
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0,viewport-fit=cover">
    <link rel="stylesheet" href="/viewer/wx/css/weui.css">
    <link rel="stylesheet" href="/viewer/wx/css/example.css"/>
    <link rel="stylesheet" href="/viewer/wx/css/jquery-weui.css">
    <link rel="stylesheet" href="/viewer/wx/css/demos.css">
    <script src="/viewer/wx/js/jquery-2.1.4.js"></script>
    <script src="/viewer/wx/js/jweixin-1.6.0.js"></script>

    <script src="/viewer/wx/js/vue.js"></script>
    <script src="/viewer/wx/js/vue-plus.js"></script>
</head>
<body>
<div class="container" id="container">
    <div class="page form_page js_show">
        <header class='demos-header'>
            <div class="weui-form__text-area">
                <h2 class="weui-form__title">我的推荐收益</h2>
            </div>
        </header>

        <div class="weui-form-preview">
            <div class="weui-form-preview__hd">
                <div class="weui-form-preview__item">
                        <label class="weui-form-preview__label">我的推荐收益</label>
                    <em class="weui-form-preview__value">{{users.length}} 笔</em>
                </div>
            </div>
            <div class="weui-form-preview__bd" v-if="users.length > 0">
                <div class="weui-form-preview__item" v-for="item in users">
                    <label class="weui-form-preview__label">{{item.work_name ? item.work_name : '未实名'}}</label>
                    <label class="weui-form-preview__label">{{item.work_hours ? item.work_hours + '小时' : '未统计'}} (时长) </label>
                    <label class="weui-form-preview__label">{{item.phone ? item.phone : ''}} </label>
                    <span class="weui-form-preview__value">￥{{item.salary}}</span>
                </div>
            </div>
            <div class="weui-form-preview__ft">
<!--                <a class="weui-form-preview__btn weui-form-preview__btn_primary" href="javascript:" v-on:click="xx()">提现</a>-->
            </div>
        </div>
        <br>
    </div>
</div>
<script src="/viewer/wx/js/fastclick.js"></script>
<script>
    $(function () {
        FastClick.attach(document.body);
    });
</script>
<script src="/viewer/wx/js/jquery-weui.js"></script>
<script src="/viewer/wx/js/ajax-util.js"></script>
</body>

<script type="application/javascript">
    new Vue({
        el: '#container',
        data: {
            users: []
        },
        created: function () {
            this.initUserInfo();
        },
        methods: {
            initUserInfo() {
                let that = this;
                if (this.getQueryString("code") || true) {
                    $.ajax({
                        url: '/viewer/wxUser/recommendSalary?code=' + this.getQueryString("code"),
                        type: 'GET',
                        async: false,
                        success: function (resp) {
                            if(resp.data) {
                                that.users = resp.data;
                            }
                        },
                        error: function (err) {
                        }
                    });
                } else {
                    $.toast("未获取到用户信息", "cancel", function (toast) {});
                }
            },
            getQueryString(name) {
                let reg = new RegExp('(^|&)' + name + '=([^&]*)(&|$)', 'i');
                let r = window.location.search.substr(1).match(reg);
                if (r != null) {
                    return unescape(r[2]);
                }
                return null;
            },
        }
    });
</script>
</html>
